% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rhs.R
\encoding{UTF-8}
\name{get_rhs_table_dpar}
\alias{get_rhs_table_dpar}
\alias{get_rhs_table_segment}
\alias{get_rhs_table}
\title{Get parameter table for a particular RHS dpar}
\usage{
get_rhs_table_dpar(
  data,
  form_rhs,
  segment,
  dpar,
  par_x,
  order = NULL,
  check_rank = TRUE
)

get_rhs_table_segment(
  form_rhs,
  segment,
  family,
  data,
  par_x,
  check_rank = TRUE
)

get_rhs_table(model, data, family, par_x, check_rank = TRUE)
}
\arguments{
\item{data}{Table-like data in long format (data.frame, tibble, data.table, etc.)}

\item{form_rhs}{The full RHS formula of a segment, including one or several \code{form}s.}

\item{segment}{Integer. The segment number}

\item{dpar}{One of \code{c("mu", "sigma", "ar")}.}

\item{par_x}{String (default: \code{NULL} which is auto-detect).}

\item{order}{Currently only applies to \code{dpar == "ar"}.}

\item{check_rank}{Boolean. Whether to stop on rank deficiency.}

\item{family}{One of \code{gaussian()}, \code{binomial()}, \code{bernoulli()}, or \code{poission()}
with a supported link function, e.g., \code{gaussian(link = "log")}.
Custom families can also be provided, e.g., \code{mcpfamily(gaussian(link = "log"))}.}

\item{model}{A list of formulas - one for each segment. The first formula
has the format \code{response ~ predictors} while the following formulas
have the format \code{response ~ changepoint ~ predictors}. The response
and change points can be omitted (\code{changepoint ~ predictors} assumes same
response. \code{~ predictors} assumes an intercept-only change point). The
following can be modeled:
\itemize{
\item \emph{Regular formulas:} e.g., \code{~ 1 + x}). \href{https://lindeloev.github.io/mcp/articles/formulas.html}{Read more}.
\item \emph{Extended formulas:}, e.g., \code{~ I(x^2) + exp(x) + sin(x)}. \href{https://lindeloev.github.io/mcp/articles/formulas.html}{Read more}.
\item \emph{Variance:} e.g., \code{~sigma(1)} for a simple variance change or
\code{~sigma(1 + I(x^2))}) for more advanced variance structures. \href{https://lindeloev.github.io/mcp/articles/variance.html}{Read more}
\item \emph{Autoregression:} e.g., \code{~ar(1)} for a simple onset/change in AR(1) or
\verb{ar(2, 0 + x}) for an AR(2) increasing by \code{x}. \href{https://lindeloev.github.io/mcp/articles/arma.html}{Read more}
}}

\item{form}{The RHS formula for a particular dpar of a segment.}
}
\value{
A tibble with one row per model parameter and the columns
\itemize{
\item \code{dpar}: character.
\item \code{segment}: the segment number (positive integer).
\item \code{display_name}: user-facing parameter name used in summary functions.
\item \code{code_name}: parameter name used in JAGS and internally in mcp.
\item \code{par_type}: One of "Intercept", "dummy", or "slope". Used for setting priors and for change point indicator func.
\item \code{order}: positive integer or NA. Currently only relevant for \code{dpar == "ar"}.
\item \code{matrix_data}: column of the design matrix less the \code{par_x} term.
}
}
\description{
This function extracts an \code{par_x}-less design matrix.
\code{par_x} will be relative to the segment onset, so it will be multiplied in in the formula
(\code{jags_code} and \code{fit$simulate()}).
}
\section{Functions}{
\itemize{
\item \code{get_rhs_table_segment}: Apply \code{get_rhs_table_dpar} to each formula in a segment

\item \code{get_rhs_table}: Apply \code{get_rhs_table_segment} to all segments of a model.
}}

\author{
Jonas Kristoffer Lindel√∏v \email{jonas@lindeloev.dk}
}
\keyword{internal}
